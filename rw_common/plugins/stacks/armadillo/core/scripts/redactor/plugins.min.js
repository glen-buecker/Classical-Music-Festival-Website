!function(t){t.add("plugin","imagemanager",{translations:{en:{choose:"Choose"}},init:function(t){this.app=t,this.lang=t.lang,this.opts=t.opts},onmodal:{image:{open:function(t,a){this.opts.imageManagerJson&&this._load(t)}}},_load:function(a){var i=a.getBody();this.$box=t.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),i.append(this.$box),t.ajax.get({url:this.opts.imageManagerJson,success:this._parse.bind(this)})},_parse:function(a){for(var i in a){var o=a[i];if("object"==typeof o){var s=t.dom("<img>"),e=o.thumb?o.thumb:o.url;s.attr("src",e),s.attr("data-params",encodeURI(JSON.stringify(o))),s.css({width:"96px",height:"72px",margin:"0 4px 2px 0",cursor:"pointer"}),s.on("click",this._insert.bind(this)),this.$box.append(s)}}},_insert:function(a){a.preventDefault();var i=t.dom(a.target),o=JSON.parse(decodeURI(i.attr("data-params")));this.app.api("module.image.insert",{image:o})}})}(Redactor);
!function(a){a.add("plugin","filemanager",{translations:{en:{choose:"Choose"}},init:function(a){this.app=a,this.lang=a.lang,this.opts=a.opts},onmodal:{file:{open:function(a,t){this.opts.fileManagerJson&&this._load(a)}}},_load:function(t){var e=t.getBody();this.$box=a.dom("<div>"),this.$box.attr("data-title",this.lang.get("choose")),this.$box.addClass("redactor-modal-tab"),this.$box.hide(),this.$box.css({overflow:"auto",height:"300px","line-height":1}),e.append(this.$box),a.ajax.get({url:this.opts.fileManagerJson,success:this._parse.bind(this)})},_parse:function(t){var e=a.dom('<ul id="redactor-filemanager-list">');for(var i in t){var s=t[i];if("object"==typeof s){var o=a.dom("<li>"),n=a.dom("<a>");n.attr("href","#"),n.addClass("redactor-file-manager-link"),n.attr("data-params",encodeURI(JSON.stringify(s))),n.text(s.title||s.name),n.on("click",this._insert.bind(this));var d=a.dom("<span>");d.addClass("r-file-name"),d.text(s.name),n.append(d);var r=a.dom("<span>");r.addClass("r-file-size"),r.text("("+s.size+")"),n.append(r),o.append(n),e.append(o)}}this.$box.append(e)},_insert:function(t){t.preventDefault();var e=a.dom(t.target).closest(".redactor-file-manager-link"),i=JSON.parse(decodeURI(e.attr("data-params")));this.app.api("module.file.insert",{file:i})}})}(Redactor);
Redactor.add("plugin","alignment",{translations:{en:{align:"Align","align-left":"Align Left","align-center":"Align Center","align-right":"Align Right","align-justify":"Align Justify"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.block=t.block,this.toolbar=t.toolbar},start:function(){var t={};t.left={title:this.lang.get("align-left"),api:"plugin.alignment.set",args:"left"},t.center={title:this.lang.get("align-center"),api:"plugin.alignment.set",args:"center"},t.right={title:this.lang.get("align-right"),api:"plugin.alignment.set",args:"right"},t.justify={title:this.lang.get("align-justify"),api:"plugin.alignment.set",args:"justify"};var i=this.toolbar.addButton("alignment",{title:this.lang.get("align")});i.setIcon('<i class="re-icon-alignment"></i>'),i.setDropdown(t)},set:function(t){if("left"===t&&"ltr"===this.opts.direction)return this._remove();var i={style:{"text-align":t}};this.block.toggle(i)},_remove:function(){this.block.remove({style:"text-align"})}});
Redactor.add("plugin","video",{translations:{en:{video:"Video","video-html-code":"Video Embed Code or Youtube/Vimeo Link"}},modals:{video:'<form action="">                     <div class="form-item">                         <label for="modal-video-input">## video-html-code ##</label>                         <textarea id="modal-video-input" name="video" style="height: 160px;"></textarea>                     </div>                 </form>'},init:function(e){this.app=e,this.lang=e.lang,this.opts=e.opts,this.toolbar=e.toolbar,this.component=e.component,this.insertion=e.insertion,this.inspector=e.inspector},onmodal:{video:{opened:function(e,i){i.getField("video").focus()},insert:function(e,i){var t=i.getData();this._insert(t)}}},oncontextbar:function(e,i){var t=this.inspector.parse(e.target);if(t.isComponentType("video")){var o=t.getComponent(),n={remove:{title:this.lang.get("delete"),api:"plugin.video.remove",args:o}};i.set(e,o,n,"bottom")}},start:function(){var e={title:this.lang.get("video"),api:"plugin.video.open"};this.toolbar.addButtonAfter("image","video",e).setIcon('<i class="re-icon-video"></i>')},open:function(){var e={title:this.lang.get("video"),width:"600px",name:"video",handle:"insert",commands:{insert:{title:this.lang.get("insert")},cancel:{title:this.lang.get("cancel")}}};this.app.api("module.modal.build",e)},remove:function(e){this.component.remove(e)},_insert:function(e){if(this.app.api("module.modal.close"),""!==e.video.trim()&&(e.video=this._matchData(e.video),this._isVideoIframe(e.video))){var i=this.component.create("video",e.video);this.insertion.insertHtml(i)}},_isVideoIframe:function(e){return null!==e.match(/<iframe|<video/gi)},_matchData:function(e){var i='<iframe style="width: 500px; height: 281px;" src="',t='" frameborder="0" allowfullscreen></iframe>';if(this._isVideoIframe(e)){var o=["iframe","video","source"];e=(e=e.replace(/<p(.*?[^>]?)>([\w\W]*?)<\/p>/gi,"")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(e,i){return-1===o.indexOf(i.toLowerCase())?"":e})}else e.match(this.opts.regex.youtube)?e=e.replace(this.opts.regex.youtube,i+"//www.youtube.com/embed/$1"+t):e.match(this.opts.regex.vimeo)&&(e=e.replace(this.opts.regex.vimeo,i+"//player.vimeo.com/video/$2"+t));return e}});
!function(i){i.add("plugin","fontsize",{translations:{en:{size:"Size","remove-size":"Remove Font Size"}},init:function(i){this.app=i,this.lang=i.lang,this.inline=i.inline,this.toolbar=i.toolbar,this.sizes=[10,11,12,14,16,18,20,24,28,30]},start:function(){for(var i={},t=0;t<this.sizes.length;t++){var e=this.sizes[t];i[t]={title:e+"px",api:"plugin.fontsize.set",args:e}}i.remove={title:this.lang.get("remove-size"),api:"plugin.fontsize.remove"};var n=this.toolbar.addButton("fontsize",{title:this.lang.get("size")});n.setIcon('<i class="re-icon-fontsize"></i>'),n.setDropdown(i)},set:function(i){var t={tag:"span",style:{"font-size":i+"px"},type:"toggle"};this.inline.format(t)},remove:function(){this.inline.remove({style:"font-size"})}})}(Redactor);
!function(t){t.add("plugin","fontcolor",{translations:{en:{fontcolor:"Text Color",text:"Text",highlight:"Highlight"}},init:function(t){this.app=t,this.opts=t.opts,this.lang=t.lang,this.inline=t.inline,this.toolbar=t.toolbar,this.selection=t.selection,this.colors=this.opts.fontcolors?this.opts.fontcolors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"]},onfontcolor:{set:function(t,e){this._set(t,e)},remove:function(t){this._remove(t)}},start:function(){var t={title:this.lang.get("fontcolor")},e=this._buildDropdown();this.$button=this.toolbar.addButton("fontcolor",t),this.$button.setIcon('<i class="re-icon-fontcolor"></i>'),this.$button.setDropdown(e)},_buildDropdown:function(){var e=t.dom('<div class="redactor-dropdown-cells">');return this.$selector=this._buildSelector(),this.$selectorText=this._buildSelectorItem("text",this.lang.get("text")),this.$selectorText.addClass("active"),this.$selectorBack=this._buildSelectorItem("back",this.lang.get("highlight")),this.$selector.append(this.$selectorText),this.$selector.append(this.$selectorBack),this.$pickerText=this._buildPicker("textcolor"),this.$pickerBack=this._buildPicker("backcolor"),e.append(this.$selector),e.append(this.$pickerText),e.append(this.$pickerBack),this._buildSelectorEvents(),e.width(242),e},_buildSelector:function(){var e=t.dom("<div>");return e.addClass("redactor-dropdown-selector"),e},_buildSelectorItem:function(e,o){var i=t.dom("<span>");return i.attr("rel",e).html(o),i.addClass("redactor-dropdown-not-close"),i},_buildSelectorEvents:function(){this.$selectorText.on("mousedown",function(t){t.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerBack.hide(),this.$pickerText.show(),this.$selectorText.addClass("active")}.bind(this)),this.$selectorBack.on("mousedown",function(t){t.preventDefault(),this.$selector.find("span").removeClass("active"),this.$pickerText.hide(),this.$pickerBack.show(),this.$selectorBack.addClass("active")}.bind(this))},_buildPicker:function(e){for(var o=t.dom('<div class="re-dropdown-box-'+e+'">'),i="backcolor"==e?"background-color":"color",s=this.colors.length,c=this,r=function(e){e.preventDefault();var o=t.dom(e.target);c._set(o.data("rule"),o.attr("rel"))},n=0;n<s;n++){var d=this.colors[n],l=t.dom("<span>");l.attr({rel:d,"data-rule":i}),l.css({"background-color":d,"font-size":0,border:"2px solid #fff",width:"22px",height:"22px"}),l.on("mousedown",r),o.append(l)}var a=t.dom("<a>");return a.attr({href:"#"}),a.css({display:"block",clear:"both",padding:"8px 5px","font-size":"12px","line-height":1}),a.html(this.lang.get("none")),a.on("click",function(t){t.preventDefault(),c._remove(i)}),o.append(a),"backcolor"==e&&o.hide(),o},_set:function(t,e){var o={};o[t]=e;var i={tag:"span",style:o,type:"toggle"};this.inline.format(i)},_remove:function(t){this.inline.remove({style:t})}})}(Redactor);
Redactor.add("plugin","counter",{translations:{en:{words:"words",chars:"chars"}},init:function(t){this.app=t,this.lang=t.lang,this.utils=t.utils,this.editor=t.editor,this.statusbar=t.statusbar},start:function(){this.editor.getElement().on("keyup.redactor-plugin-counter",this.count.bind(this)),this.count()},stop:function(){this.editor.getElement().off(".redactor-plugin-counter"),this.statusbar.remove("words"),this.statusbar.remove("chars")},count:function(){var t=0,s=0,r=0,e=this.editor.getElement().html();if(""!==(e=this._clean(e))){var a=e.split(/\s+/),i=e.match(/\s/g);t=a?a.length:0,r=i?i.length:0,s=e.length}var n={words:t,characters:s,spaces:r};this.app.broadcast("counter",n),this.statusbar.add("words",this.lang.get("words")+": "+n.words),this.statusbar.add("chars",this.lang.get("chars")+": "+n.characters)},_clean:function(t){return t=(t=(t=(t=(t=(t=(t=t.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n/gi," ")).replace(/\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),t=this.utils.removeInvisibleChars(t)}});
!function(t){t.add("plugin","textdirection",{translations:{en:{"change-text-direction":"RTL-LTR","left-to-right":"Left to Right","right-to-left":"Right to Left"}},init:function(t){this.app=t,this.lang=t.lang,this.block=t.block,this.toolbar=t.toolbar,this.selection=t.selection},start:function(){var t={};t.ltr={title:this.lang.get("left-to-right"),api:"plugin.textdirection.set",args:"ltr"},t.rtl={title:this.lang.get("right-to-left"),api:"plugin.textdirection.set",args:"rtl"};var i=this.toolbar.addButton("textdirection",{title:this.lang.get("change-text-direction")});i.setIcon('<i class="re-icon-textdirection"></i>'),i.setDropdown(t)},set:function(i){var e=this.selection.getBlock();if(e&&"LI"===e.tagName){var o=t.dom(e).parents("ul, ol",".redactor-in").last();this.block.add({attr:{dir:i}},!1,o)}else this.block.add({attr:{dir:i}})}})}(Redactor);
!function(e){e.add("plugin","table",{translations:{en:{table:"Table","insert-table":"Insert table","insert-row-above":"Insert row above","insert-row-below":"Insert row below","insert-column-left":"Insert column left","insert-column-right":"Insert column right","add-head":"Add head","delete-head":"Delete head","delete-column":"Delete column","delete-row":"Delete row","delete-table":"Delete table"}},init:function(e){this.app=e,this.lang=e.lang,this.opts=e.opts,this.caret=e.caret,this.editor=e.editor,this.toolbar=e.toolbar,this.component=e.component,this.inspector=e.inspector,this.insertion=e.insertion,this.selection=e.selection},ondropdown:{table:{observe:function(e){this._observeDropdown(e)}}},onbottomclick:function(){this.insertion.insertToEnd(this.editor.getLastNode(),"table")},start:function(){var e={observe:"table","insert-table":{title:this.lang.get("insert-table"),api:"plugin.table.insert"},"insert-row-above":{title:this.lang.get("insert-row-above"),classname:"redactor-table-item-observable",api:"plugin.table.addRowAbove"},"insert-row-below":{title:this.lang.get("insert-row-below"),classname:"redactor-table-item-observable",api:"plugin.table.addRowBelow"},"insert-column-left":{title:this.lang.get("insert-column-left"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnLeft"},"insert-column-right":{title:this.lang.get("insert-column-right"),classname:"redactor-table-item-observable",api:"plugin.table.addColumnRight"},"add-head":{title:this.lang.get("add-head"),classname:"redactor-table-item-observable",api:"plugin.table.addHead"},"delete-head":{title:this.lang.get("delete-head"),classname:"redactor-table-item-observable",api:"plugin.table.deleteHead"},"delete-column":{title:this.lang.get("delete-column"),classname:"redactor-table-item-observable",api:"plugin.table.deleteColumn"},"delete-row":{title:this.lang.get("delete-row"),classname:"redactor-table-item-observable",api:"plugin.table.deleteRow"},"delete-table":{title:this.lang.get("delete-table"),classname:"redactor-table-item-observable",api:"plugin.table.deleteTable"}},t={title:this.lang.get("table")},n=this.toolbar.addButtonBefore("link","table",t);n.setIcon('<i class="re-icon-table"></i>'),n.setDropdown(e)},insert:function(){for(var e=this.component.create("table"),t=0;t<2;t++)e.addRow(3);e=this.insertion.insertHtml(e),this.caret.setStart(e)},addRowAbove:function(){var e=this._getComponent();if(e){var t=this.selection.getCurrent(),n=e.addRowTo(t,"before");this.caret.setStart(n)}},addRowBelow:function(){var e=this._getComponent();if(e){var t=this.selection.getCurrent(),n=e.addRowTo(t,"after");this.caret.setStart(n)}},addColumnLeft:function(){var e=this._getComponent();if(e){var t=this.selection.getCurrent();this.selection.save(),e.addColumnTo(t,"left"),this.selection.restore()}},addColumnRight:function(){var e=this._getComponent();if(e){var t=this.selection.getCurrent();this.selection.save(),e.addColumnTo(t,"right"),this.selection.restore()}},addHead:function(){var e=this._getComponent();e&&(this.selection.save(),e.addHead(),this.selection.restore())},deleteHead:function(){var t=this._getComponent();if(t){var n=this.selection.getCurrent();0!==e.dom(n).closest("thead").length?(t.removeHead(),this.caret.setStart(t)):(this.selection.save(),t.removeHead(),this.selection.restore())}},deleteColumn:function(){var t=this._getComponent();if(t){var n=this.selection.getCurrent(),i=e.dom(n).closest("td, th"),o=i.nextElement().get(),a=i.prevElement().get();t.removeColumn(n),o?this.caret.setStart(o):a?this.caret.setEnd(a):this.deleteTable()}},deleteRow:function(){var t=this._getComponent();if(t){var n=this.selection.getCurrent(),i=e.dom(n).closest("tr"),o=i.nextElement().get(),a=i.prevElement().get();t.removeRow(n),o?this.caret.setStart(o):a?this.caret.setEnd(a):this.deleteTable()}},deleteTable:function(){var e=this._getTable();e&&this.component.remove(e)},_getTable:function(){var e=this.selection.getCurrent(),t=this.inspector.parse(e);if(t.isTable())return t.getTable()},_getComponent:function(){var e=this.selection.getCurrent(),t=this.inspector.parse(e);if(t.isTable()){var n=t.getTable();return this.component.create("table",n)}},_observeDropdown:function(e){var t=this._getTable(),n=e.getItemsByClass("redactor-table-item-observable"),i=e.getItem("insert-table");t?(this._observeItems(n,"enable"),i.disable()):(this._observeItems(n,"disable"),i.enable())},_observeItems:function(e,t){for(var n=0;n<e.length;n++)e[n][t]()}})}(Redactor),function(e){e.add("class","table.component",{mixins:["dom","component"],init:function(e,t){return this.app=e,t&&void 0!==t.cmnt?t:this._init(t)},addHead:function(){this.removeHead();var t=this.$element.find("tr").first().children("td, th").length,n=e.dom("<thead>"),i=this._buildRow(t,"<th>");n.append(i),this.$element.prepend(n)},addRow:function(e){var t=this._buildRow(e);return this.$element.append(t),t},addRowTo:function(e,t){return this._addRowTo(e,t)},addColumnTo:function(t,n){var i=e.dom(t),o=i.closest("tr"),a=i.closest("td, th"),r=0;o.find("td, th").each(function(e,t){e===a.get()&&(r=t)}),this.$element.find("tr").each(function(t){var i=e.dom(t).find("td, th").get(r),o=e.dom(i),a=o.clone();a.html(""),"right"===n?o.after(a):o.before(a)})},removeHead:function(){var e=this.$element.find("thead");0!==e.length&&e.remove()},removeRow:function(t){e.dom(t).closest("tr").remove()},removeColumn:function(t){var n=e.dom(t),i=n.closest("tr"),o=n.closest("td, th"),a=0;i.find("td, th").each(function(e,t){e===o.get()&&(a=t)}),this.$element.find("tr").each(function(t){var n=e.dom(t).find("td, th").get(a);e.dom(n).remove()})},_init:function(t){var n,i;if(void 0!==t){var o=e.dom(t),a=o.get(),r=o.closest("figure");0!==r.length?(n=r,i=r.find("table").get()):"TABLE"===a.tagName&&(i=a)}this._buildWrapper(n),this._buildElement(i),this._initWrapper()},_addRowTo:function(t,n){var i=e.dom(t).closest("tr");if(0!==i.length){var o=i.children("td, th").length,a=this._buildRow(o);return i[n](a),a}},_buildRow:function(t,n){n=n||"<td>";for(var i=e.dom("<tr>"),o=0;o<t;o++){var a=e.dom(n);a.attr("contenteditable",!0),i.append(a)}return i},_buildElement:function(t){t?this.$element=e.dom(t):(this.$element=e.dom("<table>"),this.append(this.$element))},_buildWrapper:function(e){e=e||"<figure>",this.parse(e)},_initWrapper:function(){this.addClass("redactor-component"),this.attr({"data-redactor-type":"table",tabindex:"-1",contenteditable:!1}),this.app.detector.isIe()&&this.removeAttr("contenteditable")}})}(Redactor);